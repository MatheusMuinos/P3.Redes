# Comprobación: atender varios clientes simultáneamente (observaciones)

Objetivo
- Comprobar que el servidor UDP puede atender datagramas de varios clientes cuando éstos se ejecutan concurrentemente.

Resumen de la modificación temporal
- En el bucle del cliente, tras enviar y recibir cada línea, se introduce un `sleep(5);` para dejar una ventana en la que lanzar un segundo cliente desde otra terminal.

Cómo probar (pasos)
1. Compilar (en la carpeta del proyecto):
   - En WSL / Git Bash:
     gcc -o servidorUDP 2_servidorUDP.c
     gcc -o clienteUDP 2_clienteUDP.c

2. Ejecutar el servidor (Terminal A):
   ./servidorUDP 12345

3. Ejecutar el primer cliente (Terminal B) con un archivo de varias líneas:
   ./clienteUDP entrada1.txt 127.0.0.1 12345

4. Mientras cliente 1 está en `sleep` (después de enviar/recibir una línea), lanzar el segundo cliente (Terminal C):
   ./clienteUDP entrada2.txt 127.0.0.1 12345

Qué observar
- En el servidor aparecerán mensajes "Recibidos X bytes de <IP>:<puerto>" para ambos clientes. Los puertos origen serán distintos (puertos efímeros).
- Las entradas en el servidor pueden intercalarse: el servidor procesa datagramas uno a uno, por lo que atenderá ambos clientes de forma secuencial pero rápida.
- Ambos clientes deben recibir sus respuestas y generar sus archivos de salida (_MAYUS...), demostrando que el servidor responde a cada remitente.

Notas importantes
- El servidor es single-threaded: "atender varios clientes" significa que responde a datagramas de diferentes clientes, pero el tratamiento es secuencial dentro del bucle principal.
- Si el servidor tarda mucho en procesar o la cola del socket se llena, pueden perderse datagramas UDP.
- El cliente usa un timeout de recepción (ej. 5 s). En la versión sugerida el `sleep` se coloca después del `recvfrom`, por lo que no provoca timeouts antes de recibir la respuesta.
- Para pruebas en la misma máquina usa IP 127.0.0.1; con máquinas distintas ten en cuenta cortafuegos/NAT.

Comprobación avanzada
- Usar tcpdump o Wireshark para inspeccionar paquetes UDP y verificar los puertos/tiempos.
- Reducir buffers o generar datagramas rápidos para probar drops y colas.
- Opcional: hacer el `sleep` configurable por parámetro del cliente para ajustar la ventana de prueba.

Conclusión
- Con la pausa introducida se puede ver claramente que el servidor recibe y responde a datagramas de múltiples clientes. UDP no garantiza entrega ni orden; para cargas altas o procesamiento lento es necesario diseñar mecanismos de reenvío/confirmación en la aplicación.